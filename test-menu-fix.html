<!DOCTYPE html>
<html>
<head>
    <title>èœå•ä¿®å¤æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 8px 16px; margin: 5px; cursor: pointer; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>èœå•ä¿®å¤æµ‹è¯•</h1>
    
    <div class="section info">
        <h3>æµ‹è¯•è¯´æ˜</h3>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºéªŒè¯å‰ç«¯èœå•ä¿®å¤æ˜¯å¦æœ‰æ•ˆ</p>
        <p>ä¿®å¤å†…å®¹ï¼š</p>
        <ul>
            <li>å°†èœå•é¡¹çš„onClickç§»åŠ¨åˆ°èœå•é…ç½®çš„æ ¹çº§åˆ«</li>
            <li>æ·»åŠ ç»Ÿä¸€çš„onClickå¤„ç†å‡½æ•°</li>
            <li>æ·»åŠ äº‹ä»¶å†’æ³¡é˜»æ­¢</li>
            <li>åˆ†ç¦»é‡å‘½åå’Œåˆ é™¤å¤„ç†é€»è¾‘</li>
        </ul>
    </div>
    
    <div class="section">
        <h3>æµ‹è¯•æ­¥éª¤</h3>
        <ol>
            <li>ç¡®ä¿ç”¨æˆ·å·²ç™»å½•</li>
            <li>ç¡®ä¿æœ‰ä¼šè¯æ•°æ®</li>
            <li>åœ¨ä¸»åº”ç”¨ä¸­å³é”®ç‚¹å‡»ä¼šè¯é¡¹</li>
            <li>æŸ¥çœ‹æ˜¯å¦å‡ºç°èœå•</li>
            <li>ç‚¹å‡»èœå•é¡¹æŸ¥çœ‹æ˜¯å¦æœ‰ååº”</li>
            <li>æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„è°ƒè¯•æ—¥å¿—</li>
        </ol>
    </div>
    
    <div class="section">
        <h3>é¢„æœŸè¡Œä¸º</h3>
        <ul>
            <li>å³é”®ç‚¹å‡»ä¼šè¯é¡¹åº”è¯¥æ˜¾ç¤ºèœå•</li>
            <li>ç‚¹å‡»"Rename"åº”è¯¥å¼¹å‡ºè¾“å…¥æ¡†</li>
            <li>ç‚¹å‡»"Delete"åº”è¯¥å¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†</li>
            <li>æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºè°ƒè¯•æ—¥å¿—ï¼š
                <ul>
                    <li><code>ğŸ¯ èœå•ç‚¹å‡»:</code></li>
                    <li><code>ğŸ”„ å¤„ç†é‡å‘½åä¼šè¯:</code></li>
                    <li><code>ğŸ—‘ï¸ å¤„ç†åˆ é™¤ä¼šè¯:</code></li>
                </ul>
            </li>
        </ul>
    </div>
    
    <div class="section">
        <h3>å¿«é€Ÿå‡†å¤‡</h3>
        <button onclick="quickSetup()">å¿«é€Ÿè®¾ç½®ï¼ˆç™»å½•+åˆ›å»ºä¼šè¯ï¼‰</button>
        <div id="setup-result"></div>
    </div>
    
    <div class="section">
        <h3>è°ƒè¯•ä¿¡æ¯</h3>
        <button onclick="checkStatus()">æ£€æŸ¥çŠ¶æ€</button>
        <div id="debug-info"></div>
    </div>

    <script>
        async function quickSetup() {
            document.getElementById('setup-result').innerHTML = '<div class="info">æ­£åœ¨è®¾ç½®...</div>';
            
            try {
                // 1. ç™»å½•
                const loginResponse = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: 'test@example.com', password: '123456' })
                });
                
                const loginData = await loginResponse.json();
                if (!loginData.success) {
                    throw new Error('ç™»å½•å¤±è´¥: ' + loginData.message);
                }
                
                localStorage.setItem('auth_token', loginData.data.token);
                localStorage.setItem('user_info', JSON.stringify(loginData.data.user));
                
                // 2. åˆ›å»ºæµ‹è¯•ä¼šè¯
                const sessionResponse = await fetch('/api/sessions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${loginData.data.token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ title: 'èœå•æµ‹è¯•ä¼šè¯ ' + new Date().toLocaleTimeString() })
                });
                
                const sessionData = await sessionResponse.json();
                if (!sessionData.success) {
                    throw new Error('åˆ›å»ºä¼šè¯å¤±è´¥: ' + sessionData.message);
                }
                
                document.getElementById('setup-result').innerHTML = 
                    '<div class="success">âœ… è®¾ç½®å®Œæˆï¼<br>å·²ç™»å½•ç”¨æˆ·: ' + loginData.data.user.email + '<br>å·²åˆ›å»ºä¼šè¯: ' + sessionData.data.title + '</div>';
                
            } catch (error) {
                document.getElementById('setup-result').innerHTML = 
                    '<div class="error">âŒ è®¾ç½®å¤±è´¥: ' + error.message + '</div>';
            }
        }
        
        function checkStatus() {
            const token = localStorage.getItem('auth_token');
            const userInfo = localStorage.getItem('user_info');
            
            let html = '<h4>è®¤è¯çŠ¶æ€:</h4>';
            if (token && userInfo) {
                try {
                    const user = JSON.parse(userInfo);
                    html += '<div class="success">âœ… å·²ç™»å½•: ' + user.email + '</div>';
                } catch (e) {
                    html += '<div class="error">âŒ ç”¨æˆ·ä¿¡æ¯è§£æå¤±è´¥</div>';
                }
            } else {
                html += '<div class="error">âŒ æœªç™»å½•</div>';
            }
            
            html += '<h4>ä¸‹ä¸€æ­¥:</h4>';
            html += '<p>1. è®¿é—®ä¸»åº”ç”¨: <a href="http://localhost:3000" target="_blank">http://localhost:3000</a></p>';
            html += '<p>2. å³é”®ç‚¹å‡»ä»»æ„ä¼šè¯é¡¹</p>';
            html += '<p>3. ç‚¹å‡»èœå•é¡¹æµ‹è¯•åŠŸèƒ½</p>';
            html += '<p>4. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„è°ƒè¯•æ—¥å¿—</p>';
            
            document.getElementById('debug-info').innerHTML = html;
        }
        
        window.onload = function() {
            checkStatus();
        };
    </script>
</body>
</html>