# ğŸ§ª æµå¼å“åº”æµ‹è¯•æŒ‡å—

æ­å–œï¼æµå¼å“åº”ç³»ç»Ÿå·²ç»å®ç°å®Œæˆã€‚ç°åœ¨ä½ å¯ä»¥æµ‹è¯•çœŸå®çš„AIæ¨¡å‹å“åº”æ•ˆæœäº†ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è®¾ç½®APIå¯†é’¥

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```bash
OPENAI_API_KEY=your_openai_api_key_here
```

### 2. å¿«é€Ÿæ¼”ç¤º (æ¨èé¦–æ¬¡ä½¿ç”¨)

```bash
npm run demo:quick
```

è¿™ä¼šè¿è¡Œä¸€ä¸ªç®€å•çš„æ¼”ç¤ºï¼Œå±•ç¤ºåŸºæœ¬çš„æµå¼å“åº”åŠŸèƒ½ã€‚

## ğŸ“‹ æµ‹è¯•é€‰é¡¹

### é€‰é¡¹1: Agentç›´æ¥æµ‹è¯• (å¼€å‘è°ƒè¯•)

```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„æµ‹è¯•åœºæ™¯
npm run test:stream:list

# è¿è¡Œæ‰€æœ‰æµ‹è¯•åœºæ™¯
npm run test:stream

# è¿è¡Œç‰¹å®šåœºæ™¯
npx tsx lib/ai/examples/real-stream-test.ts "åŸºç¡€å¯¹è¯"
```

**æµ‹è¯•åœºæ™¯åŒ…æ‹¬ï¼š**
- åŸºç¡€å¯¹è¯ - æµ‹è¯•åŸºç¡€å¯¹è¯åŠŸèƒ½å’Œæµå¼å“åº”
- èŒä¸šè¯„ä¼°å¼€å§‹ - æµ‹è¯•èŒä¸šå®šä½å·¥ä½œæµçš„å¯åŠ¨
- èŒä¸šè¯„ä¼°è¿›è¡Œä¸­ - æµ‹è¯•å·¥ä½œæµçŠ¶æ€ä¼ é€’å’Œç»§ç»­è¯„ä¼°
- æŠ€æœ¯é—®é¢˜å’¨è¯¢ - æµ‹è¯•å¸¦å†å²è®°å½•çš„æŠ€æœ¯å’¨è¯¢
- å¤æ‚æŸ¥è¯¢ - æµ‹è¯•å¤æ‚æŸ¥è¯¢çš„å¤„ç†å’Œè¯¦ç»†å“åº”

### é€‰é¡¹2: HTTP APIæµ‹è¯• (é›†æˆæµ‹è¯•)

é¦–å…ˆå¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
```bash
npm run dev
```

ç„¶ååœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰APIæµ‹è¯•åœºæ™¯
npm run test:api:list

# è¿è¡Œæ‰€æœ‰APIæµ‹è¯•
npm run test:api

# è¿è¡Œç‰¹å®šAPIæµ‹è¯•
npx tsx lib/ai/examples/api-stream-test.ts "åŸºç¡€å¯¹è¯æµ‹è¯•"
```

### é€‰é¡¹3: curlå¿«é€ŸéªŒè¯

```bash
# ç¡®ä¿å¼€å‘æœåŠ¡å™¨è¿è¡Œä¸­ï¼Œç„¶åï¼š
curl -X POST http://localhost:3000/api/ai/stream \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer test-token" \
  -d '{
    "query": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±",
    "sessionId": "test-session"
  }'
```

## ğŸ” æµ‹è¯•è¾“å‡ºè¯´æ˜

æ¯ä¸ªæµ‹è¯•ä¼šæ˜¾ç¤ºï¼š

1. **ä»»åŠ¡åˆ†é…**: CoordinatorAgenté€‰æ‹©çš„å¤„ç†èŠ‚ç‚¹
2. **æµå¼å“åº”**: å®æ—¶AIå›å¤å†…å®¹
3. **ç¬¬ä¸€ä¸ªchunkéªŒè¯**: æ£€æŸ¥workflow_stateæ˜¯å¦æ­£ç¡®åŒ…å«
4. **å®Œæˆç»Ÿè®¡**: chunkæ•°é‡ã€å­—ç¬¦æ•°ã€å“åº”æ—¶é—´
5. **SSEæ ¼å¼éªŒè¯**: Server-Sent Eventsæ ¼å¼æ£€æŸ¥

### éªŒè¯è¦ç‚¹ âœ…

- **Requirement 4.1**: Server-Sent Eventsæ ¼å¼è¾“å‡º
- **Requirement 4.2**: æ¯ä¸ªå“åº”å—åŒ…å«contentå­—æ®µ
- **Requirement 4.3**: æœ€åå“åº”å—åŒ…å«finished=true
- **Requirement 4.4**: ç¬¬ä¸€æ¡å“åº”åŒ…å«workflow_stateå­—æ®µ
- **Requirement 4.5**: é”™è¯¯å¤„ç†æ­£å¸¸å·¥ä½œ

## ğŸ¯ æµ‹è¯•ç¤ºä¾‹

### åŸºç¡€å¯¹è¯æµ‹è¯•
```bash
npm run demo:quick
```

é¢„æœŸè¾“å‡ºï¼š
```
ğŸš€ æµå¼å“åº”å¿«é€Ÿæ¼”ç¤º

1ï¸âƒ£ æ£€æŸ¥OpenAIé…ç½®...
âœ… é…ç½®éªŒè¯é€šè¿‡

2ï¸âƒ£ åˆ›å»ºå¯¹è¯Agent...
âœ… Agentåˆ›å»ºæˆåŠŸ

3ï¸âƒ£ å‘é€æŸ¥è¯¢: "ä½ å¥½ï¼Œè¯·ç®€å•ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±"
ğŸ“¡ å¼€å§‹æ¥æ”¶æµå¼å“åº”...

ğŸ” ç¬¬ä¸€ä¸ªchunkä¿¡æ¯:
   - åŒ…å«workflow_state: âœ…
   - workflow_stateå€¼: null
   - æ˜¯å¦å®Œæˆ: âŒ

ğŸ“ å“åº”å†…å®¹:
ä½ å¥½ï¼æˆ‘æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä¸“é—¨å¸®åŠ©ç”¨æˆ·è§£å†³å„ç§é—®é¢˜...

âœ… å“åº”å®Œæˆ!
ğŸ“Š ç»Ÿè®¡:
   - æ€»chunkæ•°: 15
   - æ€»å­—ç¬¦æ•°: 234
   - æœ€ç»ˆçŠ¶æ€: å·²å®Œæˆ
```

### èŒä¸šè¯„ä¼°æµ‹è¯•
```bash
npx ts-node lib/ai/examples/real-stream-test.ts "èŒä¸šè¯„ä¼°å¼€å§‹"
```

é¢„æœŸä¼šçœ‹åˆ°CoordinatorAgentå°†ä»»åŠ¡åˆ†é…ç»™career-positioningå·¥ä½œæµã€‚

### APIç«¯ç‚¹æµ‹è¯•
```bash
# å¯åŠ¨æœåŠ¡å™¨
npm run dev

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯
npm run test:api
```

é¢„æœŸä¼šçœ‹åˆ°å®Œæ•´çš„HTTPè¯·æ±‚/å“åº”æµç¨‹ã€‚

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIå¯†é’¥é”™è¯¯**
   ```
   âŒ OpenAIé…ç½®é”™è¯¯: Invalid API key
   ```
   **è§£å†³**: æ£€æŸ¥ `.env.local` ä¸­çš„ `OPENAI_API_KEY`

2. **æœåŠ¡å™¨æœªå¯åŠ¨**
   ```
   âŒ æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨
   ```
   **è§£å†³**: è¿è¡Œ `npm run dev`

3. **ä¾èµ–ç¼ºå¤±**
   ```
   âŒ Cannot find module 'ts-node'
   ```
   **è§£å†³**: è¿è¡Œ `npm install`

4. **ç½‘ç»œé—®é¢˜**
   ```
   âŒ Request timeout
   ```
   **è§£å†³**: æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒOpenAIæœåŠ¡çŠ¶æ€

## ğŸ“Š æ€§èƒ½æµ‹è¯•

### æµ‹é‡å“åº”æ—¶é—´
```bash
time npm run demo:quick
```

### å¹¶å‘æµ‹è¯• (å°å¿ƒAPIé™åˆ¶)
```bash
for i in {1..3}; do
  npm run demo:quick &
done
wait
```

## ğŸ‰ ä¸‹ä¸€æ­¥

æµ‹è¯•æˆåŠŸåï¼Œä½ å¯ä»¥ï¼š

1. **é›†æˆåˆ°å‰ç«¯**: ä½¿ç”¨fetch APIè°ƒç”¨ `/api/ai/stream`
2. **æ·»åŠ æ›´å¤šåœºæ™¯**: ç¼–è¾‘æµ‹è¯•æ–‡ä»¶æ·»åŠ è‡ªå®šä¹‰åœºæ™¯
3. **ä¼˜åŒ–æ€§èƒ½**: è°ƒæ•´æ¨¡å‹å‚æ•°å’Œå“åº”ç­–ç•¥
4. **å®ç°UI**: åˆ›å»ºèŠå¤©ç•Œé¢å±•ç¤ºæµå¼å“åº”

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `lib/ai/examples/TESTING_GUIDE.md` - è¯¦ç»†æµ‹è¯•æŒ‡å—
- `lib/ai/examples/real-stream-test.ts` - Agentç›´æ¥æµ‹è¯•
- `lib/ai/examples/api-stream-test.ts` - HTTP APIæµ‹è¯•
- `lib/ai/examples/quick-demo.ts` - å¿«é€Ÿæ¼”ç¤º
- `app/api/ai/stream/route.ts` - APIç«¯ç‚¹å®ç°
- `lib/ai/stream-utils.ts` - æµå¼å“åº”å·¥å…·

å¼€å§‹æµ‹è¯•å§ï¼ğŸš€